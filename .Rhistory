xlab("Target of intervention") +
ylab("Mean sum scores") +
theme_minimal() +
theme(axis.text.y = element_text(hjust = 1))
return(p)
}
meansumscores_plot = credplot.gg(graph, legend_table)
credplot.gg <- function(graph, legend_table){
# Remueve el prefijo "Intervention on "
graph$names <- gsub("^Intervention on ", "", graph$names)
# Une con los longnames
graph <- graph %>%
left_join(legend_table, by = "names") %>%
mutate(label = ifelse(is.na(longnames), names, longnames)) %>%
arrange(desc(m)) %>%
mutate(label = factor(label, levels = label))  # Ordena eje y
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
xlab("Target of intervention") +
ylab("Mean sum scores") +
theme_minimal() +
theme(axis.text.y = element_text(hjust = 1))
return(p)
}
meansumscores_plot = credplot.gg(graph, legend_table)
meansumscores_plot
# Une con los longnames
graph <- graph %>%
left_join(legend_table, by = "names") %>%
mutate(label = ifelse(is.na(longnames), names, longnames)) %>%
arrange(m) %>%
mutate(label = factor(label, levels = label))  # Ordena eje y
credplot.gg <- function(graph, legend_table){
# Remueve el prefijo "Intervention on "
graph$names <- gsub("^Intervention on ", "", graph$names)
# Une con los longnames
graph <- graph %>%
left_join(legend_table, by = "names") %>%
mutate(label = ifelse(is.na(longnames), names, longnames)) %>%
arrange(m) %>%
mutate(label = factor(label, levels = label))  # Ordena eje y
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
xlab("Target of intervention") +
ylab("Mean sum scores") +
theme_minimal() +
theme(axis.text.y = element_text(hjust = 1))
return(p)
}
meansumscores_plot = credplot.gg(graph, legend_table)
meansumscores_plot
credplot.gg <- function(graph, legend_table){
# Remueve el prefijo "Intervention on "
graph$names <- gsub("^Intervention on ", "", graph$names)
# Une con los longnames
graph <- graph %>%
left_join(legend_table, by = "names") %>%
mutate(label = ifelse(is.na(longnames), names, longnames)) %>%
arrange(m) %>%
mutate(label = factor(label, levels = label))  # Ordena eje y
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
xlab("Target of intervention") +
ylab("Mean sum scores") +
theme_minimal() +
theme(axis.text.y = element_text(hjust = 1))
return(p)
}
meansumscores_plot = credplot.gg(graph, legend_table)
legend_table = tibble(longnames = longnames_22,
names = shortnames_22_total)
#forestplot for the means of sumscores
mean_SampleNeg = meansumscores %>%
slice(1) %>%
pull(x)
upper_SampleNeg = u[1]
credplot.gg <- function(graph, legend_table){
# Remueve el prefijo "Intervention on "
graph$names <- gsub("^Intervention on ", "", graph$names)
# Une con los longnames
graph <- graph %>%
left_join(legend_table, by = "names") %>%
mutate(label = ifelse(is.na(longnames), names, longnames)) %>%
arrange(m) %>%
mutate(label = factor(label, levels = label))  # Ordena eje y
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
xlab("Target of intervention") +
ylab("Mean sum scores") +
theme_minimal() +
theme(axis.text.y = element_text(hjust = 1))
return(p)
}
meansumscores_plot = credplot.gg(graph, legend_table)
#calculate the sum scores of the different networks
sumSampleall<-apply(allsamples, 1, sum)
sumscores<- data.frame(sumSampleall,rowname)
meansumscores<-aggregate(sumscores$sumSampleall, by=list(sumscores$rowname), mean)
sdsumscores<-aggregate(sumscores$sumSampleall, by=list(sumscores$rowname), sd)
graphicsumscores<- data.frame(meansumscores,sdsumscores)
#calculate confidence intervals for sumscore means
m<-graphicsumscores$x
s<-graphicsumscores$x.1
u<-m+1.96*s/sqrt(3000)
l<-m-1.96*s/sqrt(3000)
confi<- cbind(graphicsumscores, m, u, l)
names<-confi$Group.1
graph<-data.frame(confi,names)
graph$names <- factor(graph$names, levels = graph$names[order(graph$m)])
graph$names
#descriptives
confi_des = confi %>%
arrange(m)
#Node names
shortnames_22_total = shortnames_23[1:22]
legend_table = tibble(longnames = longnames_22,
names = shortnames_22_total)
#forestplot for the means of sumscores
mean_SampleNeg = meansumscores %>%
slice(1) %>%
pull(x)
upper_SampleNeg = u[1]
credplot.gg <- function(graph, legend_table){
# Remueve el prefijo "Intervention on "
graph$names <- gsub("^Intervention on ", "", graph$names)
# Une con los longnames
graph <- graph %>%
left_join(legend_table, by = "names") %>%
mutate(label = ifelse(is.na(longnames), names, longnames)) %>%
arrange(m) %>%
mutate(label = factor(label, levels = label))  # Ordena eje y
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
xlab("Target of intervention") +
ylab("Mean sum scores") +
theme_minimal() +
theme(axis.text.y = element_text(hjust = 1))
return(p)
}
meansumscores_plot = credplot.gg(graph, legend_table)
meansumscores_plot
credplot.gg <- function(graph, legend_table){
# Remueve el prefijo "Intervention on "
graph$names <- gsub("^Intervention on ", "", graph$names)
# Une con longnames y agrega panel para facet
graph <- graph %>%
left_join(legend_table, by = "names") %>%
mutate(
label = ifelse(is.na(longnames), names, longnames),
panel = "Mean sum scores"  # este será el título arriba
) %>%
arrange(m) %>%
mutate(label = factor(label, levels = label))  # Ordena eje y
# Gráfico
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
facet_grid(. ~ panel) +  # Título arriba
xlab("") +               # Eje x sin título
ylab("Target of intervention") +
theme_minimal() +
theme(
axis.text.y = element_text(hjust = 1),
strip.text = element_text(size = 11, face = "bold")
)
return(p)
}
p
meansumscores_plot = credplot.gg(graph, legend_table)
meansumscores_plot
credplot.gg <- function(graph, legend_table){
# Remueve el prefijo "Intervention on "
graph$names <- gsub("^Intervention on ", "", graph$names)
# Une con longnames y agrega panel como factor
graph <- graph %>%
left_join(legend_table, by = "names") %>%
mutate(
label = ifelse(is.na(longnames), names, longnames),
panel = as.factor("Mean sum scores")  # <- forzado como factor
) %>%
arrange(m) %>%
mutate(label = factor(label, levels = label))  # Ordena eje y
# Gráfico
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
facet_grid(. ~ panel) +  # ahora funciona
xlab("") +               # Eje x sin título
ylab("Target of intervention") +
theme_minimal() +
theme(
axis.text.y = element_text(hjust = 1),
strip.text = element_text(size = 11, face = "bold")
)
return(p)
}
meansumscores_plot = credplot.gg(graph, legend_table)
meansumscores_plot
meansumscores_plot <- credplot.gg(graph, legend_table) +
theme_minimal() +
facet_grid(. ~ panel)
meansumscores_plot
credplot.gg <- function(graph, legend_table){
library(ggplot2)
library(dplyr)
# Remueve el prefijo "Intervention on "
graph$names <- gsub("^Intervention on ", "", graph$names)
# Une con longnames y agrega panel como factor
graph <- graph %>%
left_join(legend_table, by = "names") %>%
mutate(
label = ifelse(is.na(longnames), names, longnames),
panel = factor("Mean sum scores")  # <- correcto
) %>%
arrange(m) %>%
mutate(label = factor(label, levels = label))  # Ordena eje y
# Gráfico
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
facet_grid(. ~ panel) +
xlab("") +
ylab("Target of intervention") +
theme_minimal() +
theme(
axis.text.y = element_text(hjust = 1),
axis.text.x = element_text(size = 9),
axis.title = element_text(size = 10, face = "bold"),
strip.text = element_text(size = 11, face = "bold")
)
return(p)
}
meansumscores_plot <- credplot.gg(graph, legend_table)
meansumscores_plot
meansumscores_plot <- credplot.gg(graph, legend_table) +
theme_minimal() +
facet_grid(. ~ panel)
meansumscores_plot
credplot.gg <- function(graph, legend_table){
library(ggplot2)
library(dplyr)
# Remueve el prefijo "Intervention on "
graph$names <- gsub("^Intervention on ", "", graph$names)
# Une con longnames y agrega panel como factor
graph <- graph %>%
left_join(legend_table, by = "names") %>%
mutate(
label = ifelse(is.na(longnames), names, longnames),
panel = factor("Mean sum scores")  # <- correcto
) %>%
arrange(m) %>%
mutate(label = factor(label, levels = label))  # Ordena eje y
# Gráfico
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
facet_grid(. ~ panel) +
xlab("Target of intervention") +
theme_minimal()
return(p)
}
meansumscores_plot <- credplot.gg(graph, legend_table) +
theme_minimal() +
facet_grid(. ~ panel)
meansumscores_plot
# Gráfico
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
facet_grid(. ~ panel) +
xlab(" ") +
xlab("Target of intervention") +
theme_minimal()
credplot.gg <- function(graph, legend_table){
library(ggplot2)
library(dplyr)
# Remueve el prefijo "Intervention on "
graph$names <- gsub("^Intervention on ", "", graph$names)
# Une con longnames y agrega panel como factor
graph <- graph %>%
left_join(legend_table, by = "names") %>%
mutate(
label = ifelse(is.na(longnames), names, longnames),
panel = factor("Mean sum scores")  # <- correcto
) %>%
arrange(m) %>%
mutate(label = factor(label, levels = label))  # Ordena eje y
# Gráfico
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
facet_grid(. ~ panel) +
ylab("") +
xlab("Target of intervention") +
theme_minimal()
return(p)
}
meansumscores_plot <- credplot.gg(graph, legend_table) +
theme_minimal() +
facet_grid(. ~ panel)
meansumscores_plot
meansumscores_plot$facet
meansumscores_plot$facet$params
meansumscores_plot <- credplot.gg(graph, legend_table)
meansumscores_plot
credplot.gg <- function(graph, legend_table){
library(ggplot2)
library(dplyr)
# Remueve el prefijo "Intervention on "
graph$names <- gsub("^Intervention on ", "", graph$names)
# Une con longnames y agrega panel como factor
graph <- graph %>%
left_join(legend_table, by = "names") %>%
mutate(
label = ifelse(is.na(longnames), names, longnames),
panel = factor("Mean sum scores")
) %>%
arrange(m) %>%
mutate(label = factor(label, levels = label))  # Ordena eje y
# Gráfico
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
facet_grid(. ~ panel) +
ylab("") +
xlab("Target of intervention") +
theme_gray(base_size = 10) +  # cambia de minimal a gray
theme(
strip.background = element_rect(fill = "grey90", color = "black"),
strip.text = element_text(size = 11, face = "bold"),
axis.text.y = element_text(hjust = 1),
axis.text.x = element_text(size = 9)
)
return(p)
}
meansumscores_plot <- credplot.gg(graph, legend_table)
meansumscores_plot
# Gráfico
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
facet_grid(. ~ panel) +
ylab("") +
xlab("Target of intervention") +
theme_minimal()  # cambia de minimal a gray
credplot.gg <- function(graph, legend_table){
library(ggplot2)
library(dplyr)
# Remueve el prefijo "Intervention on "
graph$names <- gsub("^Intervention on ", "", graph$names)
# Une con longnames y agrega panel como factor
graph <- graph %>%
left_join(legend_table, by = "names") %>%
mutate(
label = ifelse(is.na(longnames), names, longnames),
panel = factor("Mean sum scores")
) %>%
arrange(m) %>%
mutate(label = factor(label, levels = label))  # Ordena eje y
# Gráfico
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
facet_grid(. ~ panel) +
ylab("") +
xlab("Target of intervention") +
theme_minimal()  # cambia de minimal a gray
# theme(
#   # strip.background = element_rect(fill = "grey90", color = "black"),
#   strip.text = element_text(size = 11, face = "bold"),
#   axis.text.y = element_text(hjust = 1),
#   axis.text.x = element_text(size = 9)
# )
return(p)
}
meansumscores_plot <- credplot.gg(graph, legend_table)
meansumscores_plot
credplot.gg <- function(graph, legend_table){
library(ggplot2)
library(dplyr)
# Remueve el prefijo "Intervention on "
graph$names <- gsub("^Intervention on ", "", graph$names)
# Une con longnames y agrega panel como factor
graph <- graph %>%
left_join(legend_table, by = "names") %>%
mutate(
label = ifelse(is.na(longnames), names, longnames),
panel = factor("Mean sum scores")
) %>%
arrange(m) %>%
mutate(label = factor(label, levels = label))  # Ordena eje y
# Gráfico
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
facet_grid(. ~ panel) +
xlab("Target of intervention") +
ylab("") +
theme_minimal(base_size = 10) +  # base minimal
theme(
strip.background = element_rect(fill = "grey90", color = "black"),  # agrega caja facet
strip.text = element_text(size = 11, face = "bold"),
axis.text.y = element_text(hjust = 1),
axis.text.x = element_text(size = 9)
)
return(p)
}
meansumscores_plot <- credplot.gg(graph, legend_table)
meansumscores_plot
?theme(axis.text.y=element_text(hjust=1))
?centralityPlot
credplot.gg <- function(graph, legend_table){
# Remueve el prefijo "Intervention on "
graph$names <- gsub("^Intervention on ", "", graph$names)
# Une con longnames y agrega panel como factor
graph <- graph %>%
left_join(legend_table, by = "names") %>%
mutate(
label = ifelse(is.na(longnames), names, longnames),
panel = factor("Mean sum scores")
) %>%
arrange(m) %>%
mutate(label = factor(label, levels = label))  # Ordena eje y
# Gráfico
p <- ggplot(graph, aes(x = label, y = m, ymin = l, ymax = u)) +
geom_pointrange() +
geom_hline(yintercept = upper_SampleNeg, linetype = "dashed") +
geom_hline(yintercept = upper_SampleNeg + 2, linetype = "dotted") +
scale_y_continuous(limits = c(-6, -1)) +
coord_flip() +
facet_grid(. ~ panel) +
xlab("Target of intervention") +
ylab("") +
theme_bw() +  # base minimal
theme(axis.text.y=element_text(hjust=1))
return(p)
}
meansumscores_plot <- credplot.gg(graph, legend_table)
meansumscores_plot
# jpg
ggsave(here("Output", "Fig_5.jpg"), meansumscores_plot, height = 4, width = 8)
# pdf
ggsave(here("Output", "PDF", "Fig_5.pdf"), meansumscores_plot, height = 4, width = 8,
dpi = 600,
device = "pdf")
# jpg
ggsave(here("Output", "Fig_5.jpg"), meansumscores_plot, height = 4, width = 8)
# pdf
ggsave(here("Output", "PDF", "Fig_5.pdf"), meansumscores_plot, height = 4, width = 8,
dpi = 600,
device = "pdf")
# Save as EPS
setEPS()
postscript(file = here("Output", "EPS", "Fig_5.eps"),
width = 8, height = 4,
horizontal = FALSE,
paper = "special",
onefile = FALSE)
print(meansumscores_plot)
# Close the EPS device
dev.off()
image_write
